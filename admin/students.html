<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin – Student Applications</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ⚠️ CSS SAME AS BEFORE – NO CHANGE */
body{font-family:Arial,sans-serif;background:#f5f5f5;margin:0}
.container{max-width:1000px;margin:15px auto;background:#fff;padding:12px 15px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.2)}
h1{margin-top:0;color:#b20c0c}
table{width:100%;border-collapse:collapse;margin-top:10px;font-size:13px}
th,td{border:1px solid #ddd;padding:6px;text-align:left}
th{background:#eee}
tr:nth-child(even){background:#fafafa}
button{padding:5px 8px;border:none;border-radius:4px;cursor:pointer;font-size:12px;margin:2px}
.btn-view{background:#1976d2;color:#fff}
.btn-approve{background:#2e7d32;color:#fff}
.btn-pending{background:#ffa000;color:#000}
.btn-reject{background:#c62828;color:#fff}
.msg{margin-top:6px;font-size:13px}
.detail-card{margin-top:12px;padding:10px;border-radius:6px;background:#fafafa;border:1px solid #ddd;font-size:14px}
.field-label{font-weight:bold}
a{color:#1976d2}
.section-title{margin-top:10px;font-weight:bold;border-bottom:1px solid #ccc;padding-bottom:3px;margin-bottom:4px}
</style>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>

<div class="container">
<h1>Student Applications</h1>
<p class="msg" id="listMsg">Loading...</p>

<table>
<thead>
<tr>
<th>#</th>
<th>Roll</th>
<th>Name</th>
<th>Mobile</th>
<th>Exam Level</th>
<th>Centre</th>
<th>Form Status</th>
<th>Payment</th>
<th>Action</th>
</tr>
</thead>
<tbody id="appsBody"></tbody>
</table>

<div id="detailBox" class="detail-card" style="display:none;">
<div class="section-title">Student Details</div>
<p><b>Name:</b> <span id="dName"></span></p>
<p><b>Father:</b> <span id="dFather"></span></p>
<p><b>Mobile:</b> <span id="dMobile"></span></p>
<p><b>Roll:</b> <span id="dRoll"></span></p>
<p><b>Exam Level:</b> <span id="dExamLevel"></span></p>
<p><b>Status:</b> <span id="dStatus"></span></p>
<p><b>Payment:</b> <span id="dPayment"></span></p>
<p><b>UPI Txn:</b> <span id="dTxn"></span></p>
<p><b>Address:</b> <span id="dAddress"></span></p>
<p><b>Qualification:</b> <span id="dQual"></span></p>
</div>

</div>

<script>
const sb = supabase.createClient(
"https://yyymjhuwjvyykukfzqow.supabase.co",
"YOUR-ANON-KEY"
);

async function loadStudents(){
const { data } = await sb.from("students").select("*").order("created_at",{ascending:false});
const body=document.getElementById("appsBody");
body.innerHTML="";
let i=1;
data.forEach(st=>{
if(!st.roll_number) return;
body.innerHTML+=`
<tr>
<td>${i++}</td>
<td>${st.roll_number}</td>
<td>${st.full_name||""}</td>
<td>${st.mobile||""}</td>
<td>${st.exam_level||"-"}</td>
<td>${st.exam_center||"-"}</td>
<td>${st.form_status||""}</td>
<td>${st.payment_status||""}</td>
<td><button onclick='openDetails(${JSON.stringify(st)})'>View</button></td>
</tr>`;
});
}
loadStudents();

function openDetails(st){
document.getElementById("detailBox").style.display="block";
dName.textContent=st.full_name||"";
dFather.textContent=st.father_name||"";
dMobile.textContent=st.mobile||"";
dRoll.textContent=st.roll_number||"";
dExamLevel.textContent=st.exam_level||"-";
dStatus.textContent=st.form_status||"";
dPayment.textContent=st.payment_status||"";
dTxn.textContent=st.upi_txn||"";
dAddress.textContent=st.address||"";
dQual.textContent=st.qualification||"";
}
</script>

</body>
</html>
