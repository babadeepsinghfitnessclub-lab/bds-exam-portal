<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin – Student Applications</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; }
  .container {
    max-width: 1000px;
    margin: 15px auto;
    background:#fff;
    padding: 12px 15px;
    border-radius:8px;
    box-shadow:0 2px 8px rgba(0,0,0,0.2);
  }
  h1 { margin-top:0; color:#b20c0c; }
  table { width:100%; border-collapse: collapse; margin-top:10px; font-size:13px; }
  th, td { border:1px solid #ddd; padding:6px; text-align:left; }
  th { background:#eee; }
  tr:nth-child(even){ background:#fafafa; }
  button { padding:5px 8px; border:none; border-radius:4px; cursor:pointer; font-size:12px; margin:2px; }
  .btn-view { background:#1976d2; color:#fff; }
  .btn-approve { background:#2e7d32; color:#fff; }
  .btn-pending { background:#ffa000; color:#000; }
  .btn-reject { background:#c62828; color:#fff; }
  .msg { margin-top:6px; font-size:13px; }
  .detail-card {
    margin-top:12px; padding:10px; border-radius:6px;
    background:#fafafa; border:1px solid #ddd; font-size:14px;
  }
  .field-label { font-weight:bold; }
  a { color:#1976d2; }
  .topbar-links a { margin-right:8px; font-size:13px; }
  .section-title{
    margin-top:10px; font-weight:bold;
    border-bottom:1px solid #ccc; padding-bottom:3px; margin-bottom:4px;
  }
</style>

<script src="https://unpkg.com/@supabase/supabase-js"></script>
</head>

<body>
<div class="container">

<div class="topbar-links">
  <a href="dashboard.html">← Admin Home</a> |
  <a href="../index.html" target="_blank">Open Website</a>
</div>

<h1>Student Applications</h1>
<p class="msg" id="listMsg">Loading...</p>

<table>
<thead>
<tr>
  <th>#</th>
  <th>Roll</th>
  <th>Name</th>
  <th>Mobile</th>
  <th>Exam Level</th> <!-- ✅ ADDED -->
  <th>Centre</th>
  <th>Form Status</th>
  <th>Payment</th>
  <th>Action</th>
</tr>
</thead>
<tbody id="appsBody"></tbody>
</table>

<div id="detailBox" class="detail-card" style="display:none;">
<div class="section-title">Student Details</div>

<p><span class="field-label">Name:</span> <span id="dName"></span></p>
<p><span class="field-label">Father:</span> <span id="dFather"></span></p>
<p><span class="field-label">Mobile:</span> <span id="dMobile"></span></p>
<p><span class="field-label">Roll No:</span> <span id="dRoll"></span></p>

<p><span class="field-label">Exam Level:</span> <span id="dExamLevel"></span></p> <!-- ✅ ADDED -->

<p><span class="field-label">Form Status:</span> <span id="dStatus"></span></p>
<p><span class="field-label">Payment Status:</span> <span id="dPayment"></span></p>
<p><span class="field-label">UPI Txn ID:</span> <span id="dTxn"></span></p>
<p><span class="field-label">Address:</span> <span id="dAddress"></span></p>
<p><span class="field-label">Qualification:</span> <span id="dQual"></span></p>

</div>
</div>

<script>
const { createClient } = supabase;
const sb = createClient(
  "https://yyymjhuwjvyykukfzqow.supabase.co",
  "YOUR_PUBLIC_ANON_KEY"
);

async function loadStudents(){
  const { data } = await sb.from("students").select("*").order("created_at",{ascending:false});
  const body = document.getElementById("appsBody");
  body.innerHTML = "";
  let i=1;

  data.forEach(st=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${i++}</td>
      <td>${st.roll_number}</td>
      <td>${st.full_name}</td>
      <td>${st.mobile}</td>
      <td>${st.exam_level || "-"}</td> <!-- ✅ -->
      <td>${st.exam_center || "-"}</td>
      <td>${st.form_status}</td>
      <td>${st.payment_status}</td>
      <td><button class="btn-view">View</button></td>
    `;
    tr.querySelector(".btn-view").onclick = ()=>openDetails(st);
    body.appendChild(tr);
  });

  document.getElementById("listMsg").textContent = "Loaded successfully";
}

function openDetails(st){
  document.getElementById("detailBox").style.display="block";
  document.getElementById("dName").textContent = st.full_name;
  document.getElementById("dFather").textContent = st.father_name;
  document.getElementById("dMobile").textContent = st.mobile;
  document.getElementById("dRoll").textContent = st.roll_number;
  document.getElementById("dExamLevel").textContent = st.exam_level || "-"; // ✅
  document.getElementById("dStatus").textContent = st.form_status;
  document.getElementById("dPayment").textContent = st.payment_status;
  document.getElementById("dTxn").textContent = st.upi_txn;
  document.getElementById("dAddress").textContent = st.address;
  document.getElementById("dQual").textContent = st.qualification;
}

loadStudents();
</script>

</body>
</html>
